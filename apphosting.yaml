# Configuration App Hosting pour un projet Vite + Firebase

runConfig:
  minInstances: 2
  maxInstances: 100
  concurrency: 100
  cpu: 2
  memoryMiB: 1024

# S'assurer que le build et le run font ce qu'on attend
scripts:
  buildCommand: npm ci && npm run build
  runCommand: node server.js

# Forcer l'inclusion des artefacts nécessaires à l'exécution
outputFiles:
  serverApp:
    include: [dist, server.js]

env:
  # Clés du SDK Web Firebase (⚠️ PAS des clés privées Admin !)
  - variable: VITE_FIREBASE_API_KEY
    value: AIzaSyCtKMjQbbn8SSF4-kiNf2g0k10ddBuHB_k
    availability: [BUILD]

  - variable: VITE_FIREBASE_AUTH_DOMAIN
    value: ranko-2ad7a.firebaseapp.com
    availability: [BUILD]

  - variable: VITE_FIREBASE_PROJECT_ID
    value: ranko-2ad7a
    availability: [BUILD]

  - variable: VITE_FIREBASE_STORAGE_BUCKET
    value: ranko-2ad7a.firebasestorage.app
    availability: [BUILD, RUNTIME]

  - variable: VITE_FIREBASE_MESSAGING_SENDER_ID
    value: 185493898227
    availability: [BUILD]

  - variable: VITE_FIREBASE_APP_ID
    value: 1:185493898227:web:0a105d36982e3bab560886
    availability: [BUILD]

  # Permet d'installer les deps de build (Vite, etc.)
  - variable: NPM_CONFIG_PRODUCTION
    value: "false"
    availability: [BUILD]

  # Environnement runtime
  - variable: NODE_ENV
    value: production
    availability: [RUNTIME]
